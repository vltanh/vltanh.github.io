<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="google-site-verification" content="1BWHOhCt_eijp5wvU_9Cvh591AfMs_im4cOLhN3wkP4"> <meta http-equiv="Permissions-Policy" content="interest-cohort=()"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Máy Boltzmann (Phần 1) | The-Anh Vu-Le (Nah) </title> <meta name="author" content="The-Anh Vu-Le"> <meta name="description" content="a fake trying to be real "> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%90%96&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://vltanh.github.io//blog/2023/bm-rbm-meanfield/"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?0afe9f0ae161375728f7bcc5eb5b4ab4"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> </head> <body> <d-front-matter> <script async type="text/json">
      {
            "title": "Máy Boltzmann (Phần 1)",
            "description": "",
            "published": "April 26, 2023",
            "authors": [
              
              {
                "author": "The-Anh Vu-Le",
                "authorURL": "",
                "affiliations": [
                  {
                    "name": "",
                    "url": ""
                  }
                ]
              }
              
            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> The-Anh Vu-Le (Nah) </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>Máy Boltzmann (Phần 1)</h1> <p></p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div> <a href="#t%E1%BB%95ng-quan">Tổng quan</a> </div> <ul> <li> <a href="#m%C3%B4-h%C3%ACnh-n%C4%83ng-l%C6%B0%E1%BB%A3ng">Mô hình năng lượng</a> </li> <li> <a href="#m%C3%A1y-boltzmann">Máy Boltzmann</a> </li> <li> <a href="#m%C3%A1y-boltzmann-gi%E1%BB%9Bi-h%E1%BA%A1n">Máy Boltzmann giới hạn</a> </li> </ul> <div> <a href="#t%C3%ADnh-to%C3%A1n">Tính toán</a> </div> <ul> <li> <a href="#ch%E1%BA%B7n-d%C6%B0%E1%BB%9Bi-bi%E1%BA%BFn-ph%C3%A2n">Chặn dưới biến phân</a> </li> <li> <a href="#x%E1%BA%A5p-x%E1%BB%89-mean-field">Xấp xỉ mean-field</a> </li> </ul> </nav> </d-contents> <h2 id="tổng-quan">Tổng quan</h2> <h3 id="mô-hình-năng-lượng">Mô hình năng lượng</h3> <p>Mô hình năng lượng (energy-based model) là một họ các phân phối có hàm mật độ được định nghĩa trên một siêu hộp (hypercube) \(\{ 0, 1 \}^d\)</p> \[\begin{align} p(x; \theta) = \dfrac{1}{Z(\theta)} \exp(-E(x; \theta)) \end{align}\] <p>trong đó</p> \[\begin{align} Z(\theta) = \sum_{x \in \{0, 1\}^d} \exp(-E(x; \theta)) \end{align}\] <p>là hệ số chuẩn hóa (normalization factor). Ngoài ra, \(Z\) còn được gọi là hàm phân hoạch (partition function).</p> <p>Một đặc điểm của các phân phối thuộc dạng này là nó phụ thuộc vào hàm năng lượng \(E\), được tham số hóa bởi \(\theta\). Hàm này gán một giá trị năng lượng cho từng cấu hình (configuration) \(x\). Có thể nhận thấy, các cấu hình có năng lượng càng thấp (càng âm) thì sẽ có xác suất càng cao.</p> <p>Một tính chất đáng quan tâm khác là hàm \(Z\) thường rất khó để tính: một cách ngây thơ sẽ là duyệt qua tất cả \(2^d\) cấu hình có thể. Do đó, việc lấy mẫu (sampling) hoặc suy luận (inference) từ mô hình năng lượng sẽ gặp các khó khăn nhất định.</p> <h3 id="máy-boltzmann">Máy Boltzmann</h3> <p>Máy Boltzmann (Boltzmann machine) là một mô hình năng lượng với cấu trúc đặc biệt. Một cấu hình được phân thành 2 phần \(x = (v, h)\): các trạng thái hiện (visible states) \(v \in \{0, 1\}^{d_v}\) và trạng thái ẩn (hidden states) \(h \in \{ 0, 1 \}^{d_h}\). Máy Boltzmann tổng quát có hàm năng lượng được tham số hóa bởi \(\theta = (W, A, B, a, b)\) với \(W \in \mathbb{R}^{d_h \times d_v}\), \(A \in \mathbb{R}^{d_v \times d_v}\), \(B \in \mathbb{R}^{d_h \times d_h}\), \(a \in \mathbb{R}^{d_v}\), \(b \in \mathbb{R}^{d_h}\) và có dạng như sau</p> \[\begin{align} E(v, h; W, A, B, a, b) = - \langle v, Wh \rangle - \dfrac{1}{2} \langle v, Av \rangle - \dfrac{1}{2} \langle h, Bh \rangle - \langle v, a \rangle - \langle h, b \rangle \end{align}\] <p>Có thể hiểu là \(W\) mô hình tương tác giữa trạng thái hiện và trạng thái ẩn, \(A, B\) lần lượt mô hình tương tác giữa các trạng thái hiện và tương tác giữa các trạng thái ẩn.</p> <p>Khi ta mô hình hóa một tập dữ liệu sử dụng máy Boltzmann, với mỗi điểm dữ liệu, chúng ta thường xem phần quan sát được là trạng thái hiện, và kèm với nó là các trạng thái ẩn không quan sát được. Từ đó, ta hy vọng có thể mô hình hóa được các tương tác ẩn không quan sát được từ dữ liệu hiện có. Phân phối biên (marginal distribution) của trạng thái hiện được tính như sau.</p> \[\begin{align} p(v; \theta) = \sum_{h \in \{0, 1\}^{d_h}} p(v, h; \theta) \end{align}\] <h3 id="máy-boltzmann-giới-hạn">Máy Boltzmann giới hạn</h3> <p>Máy Boltzmann giới hạn (Restricted Boltzmann Machine) là một trường hợp cụ thể của máy Boltzmann khi không có tương tác giữa các trạng thái hiện với nhau, cũng như không có tương tác giữa các trạng thái ẩn với nhau.</p> <p>Do đó, hàm năng lượng chỉ là</p> \[\begin{align} E(v, h; W, a, b) = - \langle v, Wh \rangle - \langle v, a \rangle - \langle h, b \rangle \end{align}\] <p>Có thể xem máy Boltzmann giới hạn như là một máy Boltzmann với \(A = B = 0\).</p> <h2 id="tính-toán">Tính toán</h2> <h3 id="chặn-dưới-biến-phân">Chặn dưới biến phân</h3> <p>Một cách để xấp xỉ \(p(v, h; \theta)\) chính là phương pháp suy diễn biến phân (variational inference). Mục tiêu cụ thể của phương pháp này là ước lượng hợp lý cực đại (maximum likelihood estimation): tìm tham số \(\theta\) sao cho hàm hợp lý là lớn nhất. Như đã nói ở trên, điều này khó có thể được thực hiện trực tiếp. Do đó, cách tiếp cận là (1) đề xuất một họ mô hình (phân bố) mà ta có thể suy diễn được và (2) tối ưu để có thể sử dụng mô hình này để xấp xỉ mô hình gốc của chúng ta.</p> <p>Cụ thể, chọn phân bố \(q(h \\| v; \phi)\) là mô hình của chúng ta về trạng thái ẩn khi biết trạng thái hiện, được tham số hóa bởi \(\phi\). Ta có thể tìm được chặn dưới của hàm log-likelihood (xin phép không dịch, nôm nà là log của hàm hợp lý) như sau.</p> <p>Đầu tiên, ta biến đổi hàm này thành dạng</p> \[\begin{align} \begin{split} \log p(v; \theta) =&amp; \log \sum_{h} p(v, h; \theta) \\ =&amp; \log \sum_{h} \dfrac{p(v, h; \theta)}{q(h | v; \phi)} q(h | v; \phi) \\ =&amp; \log \left[ \mathbb{E}_{h \sim q(h|v; \phi)} \dfrac{p(v, h; \theta)}{q(h | v; \phi)} \right] \end{split} \end{align}\] <p>Sử dụng bất đẳng thức Jensen cho hàm lõm \(\log\), ta có chặn dưới</p> \[\begin{align} \begin{split} \log p(v; \theta) &amp; \geq \mathbb{E}_{h \sim q(h | v; \phi)} \left[ \log \dfrac{p(v, h; \theta)}{q(h | v; \phi)} \right] \\ &amp; = \mathbb{E}_{h \sim q(h | v; \phi)} \log p(v, h; \theta) + H(q(h | v; \phi)) \\ &amp; =: \text{ELBO}(\phi) \end{split} \end{align}\] <p>với \(H(q(h \\| v; \phi)) = - \mathbb{E}_{h \sim q(h \\| v; \phi)} \log q(h \\| v; \phi)\) là entropy của \(q(h \\| v; \phi)\).</p> <p>Việc tìm tham số \(\theta\) để tối ưu log-likelihood trở thành việc tìm tham số \(\phi\) để tối ưu chặn dưới này. Do \(q\) nằm trong quyền kiểm soát của chúng ta nên việc này trở nên khả thi. Ngoài ra, có thể chứng minh được việc tìm \(\phi\) để tối ưu chặn dưới này tương đương với việc tìm \(\phi\) để xấp xỉ tốt nhất \(p(\cdot; \theta)\) (theo phân kỳ Kullback-Leibler). Điều này cũng giải thích tại sao phương pháp này được gọi là suy diễn biến phân (variational inference). Phần tiếp theo sẽ trình bày cách tối ưu hàm chặn dưới này cho một trường hợp cụ thể.</p> <h3 id="xấp-xỉ-mean-field">Xấp xỉ mean-field</h3> <p>Ta xét cụ thể một lớp các phân bố \(q(h \\| v; \phi)\) có thể phân rã như sau. Điều này có nghĩa là khi biết trạng thái hiện \(v\), các trạng thái ẩn được giả định là độc lập với nhau. Giả định này có thể không hợp lý trong thực tế, nhưng lại giúp đỡ rất nhiều trong nghiên cứu và ứng dụng. Phương pháp này được gọi là xấp xỉ mean-field (mean-field approximation).</p> \[\begin{align} q(h | v; \phi) = \prod_{j=1}^d q(h_j | v; \phi) \end{align}\] <p>trong đó \(\phi = (\mu_j)_{j=1}^{d}\) với \(\mu_j = q(h_j = 1 \\| v), \forall j = 1, \dots, d_h\).</p> <p>Với lựa chọn này, ta có thể chứng minh được \(\mu_j\) thỏa mãn</p> \[\begin{align} \label{eq:mu_j} \mu_j = \sigma \left( \sum_{i} W_{ij} v_i + \sum_{l \neq j} A_{lj} \mu_l + b_j \right) \end{align}\] <p>Gọi \(h_{-j} = (h_1, \dots, h_{j-1}, h_{j+1}, \dots, h_{d_h})\). Nói cách khác, \(h_{-j}\) bao gồm mọi giá trị của \(h\) trừ \(h_j\).</p> <p>Chọn một chiều \(j \in \{ 1, \dots, d_h \}\) cụ thể. Ta có thể tìm \(\mu_j\) để tối ưu chặn dưới biến phân bằng cách phương pháp đạo hàm. Do đó, ta sẽ tìm đạo hàm của \(\text{ELBO}(\phi)\) theo \(\mu_j\).</p> <p>Trước hết, ta xét hạng tử entropy.</p> \[\begin{align} \begin{split} H(q(h | v; \phi)) =&amp; - \sum_h q(h | v; \phi) \sum_{k=1}^{d} \log q(h_k|v; \phi) \\ =&amp; - \sum_{k=1}^{d} \sum_{h_k, h_{-k}} q(h_k|v; \phi) q(h_{-k}|v; \phi) \log q(h_k|v; \phi) \\ =&amp; - \sum_{k=1}^{d} \sum_{h_{-k}} q(h_{-k}|v; \phi) \sum_{h_k} q(h_k|v; \phi) \log q(h_k|v; \phi) \\ =&amp; - \sum_{k=1}^{d} \sum_{h_k} q(h_k|v; \phi) \log q(h_k|v; \phi) \\ =&amp; - \sum_{k=1}^{d} \mu_k \log \mu_k + (1 - \mu_k) \log (1 - \mu_k) \end{split} \end{align}\] <p>Do chỉ quan tâm đến $\mu_j$, trong biểu thức này, ta chỉ quan tâm đến hạng tử</p> \[\begin{align} - \mu_j \log \mu_j - (1 - \mu_j) \log (1 - \mu_j) \end{align}\] <p>Tiếp đến, để phân tích hạng tử kỳ vọng, ta thực hiện phân rã sau.</p> \[\begin{align} \begin{split} p(v, h; \theta) &amp; = p(v; \theta) p(h|v;\theta) \\ &amp; = p(v; \theta) p(h_{-j} | v; \theta) p(h_j|h_{-j}, v;\theta) \end{split} \end{align}\] <p>Như vậy,</p> \[\begin{align} \begin{split} &amp; \mathbb{E}_{h \sim q(h|v;\phi)} \log p(v,h;\theta) \\ = &amp; \mathbb{E}_{h \sim q(h|v;\phi)} [ \log p(v; \theta) + \log p(h_{-j} | v; \theta) + \log p(h_j | h_{-j}, v; \theta) ] \end{split} \end{align}\] <p>Hạng tử thứ nhất, \(\log p(v; \theta)\), không phụ thuộc vào \(h\) hay \(\mu_j\). Do đó, ta không cần quan tâm đến nó.</p> <p>Hạng tử thứ hai, \(\log p(h_{-j} \\| v; \theta)\), cũng có thể bị loại bỏ bởi vì</p> \[\begin{align} \begin{split} &amp; \sum_h q(h|v; \phi) \log p(h_{-j} | v; \theta) \\ =&amp; \sum_{h_j, h_{-j}} q(h_j|v; \phi) q(h_{-j}|v; \phi) \log p(h_{-j} | v; \theta) \\ =&amp; \left[ \sum_{h_j} q(h_j|v; \phi) \right] \sum_{h_{-j}} q(h_{-j}|v; \phi) \log p(h_{-j} | v; \theta) \\ =&amp; \sum_{h_{-j}} q(h_{-j}|v; \phi) \log p(h_{-j} | v; \theta) \end{split} \end{align}\] <p>không phụ thuộc vào \(\mu_j\).</p> <p>Hạng tử thứ ba, \(\log p(h_j \\| h_{-j}, v; \theta)\), có thể được biến đổi như sau.</p> \[\begin{align} \begin{split} &amp; \sum_h q(h|v; \phi) \log p(h_j | h_{-j}, v; \theta) \\ =&amp; \sum_{h_j, h_{-j}} q(h_j|v; \phi) q(h_{-j}|v; \phi) \log p(h_j | h_{-j}, v; \theta) \\ =&amp; \sum_{h_{-j}} q(h_{-j}|v; \phi) \left[ \sum_{h_j} q(h_j|v; \phi) \log p(h_j | h_{-j}, v; \theta) \right] \\ =&amp; \mathbb{E}_{h_{-j} \sim q(h_{-j}|v; \phi)} \left[ \mu_j \log \eta_j + (1 - \mu_j) \log (1 - \eta_j) \right] \end{split} \end{align}\] <p>trong đó, \(\eta_j := p(h_j = 1 \\| h_{-j}, v; \theta)\).</p> <p>Tổng kết lại, phần liên quan đến \(\mu_j\) của \(\text{ELBO}\) là</p> \[\begin{align} - \mathbb{E}_{h_{-j} \sim q(h_{-j}|v; \phi)} \left[ \mu_j \log \dfrac{\mu_j}{\eta_j} + (1 - \mu_j) \log \dfrac{1 - \mu_j}{1 - \eta_j} \right] \end{align}\] <p>Lấy đạo hàm theo \(\mu_j\), ta có</p> \[\begin{align} \begin{split} &amp; -\mathbb{E}_{h_{-j} \sim q(h_{-j}|v; \phi)} \left[ \log \dfrac{\mu_j}{\eta_j} - \log \dfrac{1 - \mu_j}{1 - \eta_j} \right] \\ =&amp; \mathbb{E}_{h_{-j} \sim q(h_{-j}|v; \phi)} \left[ \log \dfrac{\eta_j}{1 - \eta_j} - \log \dfrac{\mu_j}{1 - \mu_j} \right] \end{split} \end{align}\] <p>Đặt nó bằng \(0\) và biến đổi, ta được</p> \[\begin{align} \log \dfrac{\mu_j}{1 - \mu_j} = \mathbb{E}_{h_{-j} \sim q(h_{-j}|v; \phi)} \log \dfrac{\eta_j}{1 - \eta_j} \end{align}\] <p>hay</p> \[\begin{align} \mu_j = \sigma \left( \mathbb{E}_{h_{-j} \sim q(h_{-j}|v; \phi)} \log \dfrac{\eta_j}{1 - \eta_j} \right) \end{align}\] <p>với \(\sigma(x) = \dfrac{1}{1 + e^{-x}}\) là hàm sigmoid.</p> <p>Đặt \(h^{(1)} = (h_1, \dots, h_{j-1}, 1, h_{j+1}, \dots, h_{d_h})\) và \(h^{(0)} = (h_1, \dots, h_{j-1}, 0, h_{j+1}, \dots, h_{d_h})\). Nói cách khác, \(h^{(t)}\) là \(h\) với \(h_j = t\).</p> <p>Khi đó,</p> \[\begin{align} \begin{split} &amp; \log \dfrac{\eta_j}{1 - \eta_j} \\ &amp;= \log \dfrac{p(h_j = 1| h_{-j}, v; \theta)}{p(h_j = 0| h_{-j}, v; \theta)} \\ &amp;= \log \dfrac{p(v, h^{(1)}; \theta)}{p(v, h^{(0)}; \theta)} \\ &amp;= \log \dfrac{\exp(-E(v, h^{(1)}; \theta))}{\exp(-E(v, h^{(0)}; \theta))} \\ &amp;= E(v, h^{(0)}; \theta) - E(v, h^{(1)}; \theta) \end{split} \end{align}\] <p>Hiệu số giữa hai hàm năng lượng chỉ thật sự khác biệt ở vị trí \(j\). Do đó,</p> \[\begin{align} \begin{split} &amp; E(v, h^{(0)}; \theta) - E(v, h^{(1)}; \theta) \\ &amp;= \left( - \sum_{i} W_{ij} v_i \times 0 - 2 \times \dfrac{1}{2} \sum_{l \neq j} A_{lj} h_l \times 0 - b_j \times 0 \right) \\ &amp; - \left( - \sum_{i} W_{ij} v_i \times 1 - 2 \times \dfrac{1}{2} \sum_{l \neq j} A_{lj} h_l \times 1 - b_j \times 1 \right) \\ &amp;= \sum_{i} W_{ij} v_i + \sum_{l \neq j} A_{lj} h_l + b_j \end{split} \end{align}\] <p>Từ đó,</p> \[\begin{align} \begin{split} &amp; \mathbb{E}_{h_{-j} \sim q(h_{-j}|v; \phi)} \log \dfrac{p(h_j = 1 | h_{-j}, v; \theta)}{p(h_j = 0 | h_{-j}, v; \theta)} \\ =&amp; \sum_{i} W_{ij} x_i + \sum_{l \neq j} A_{lj} \mathbb{E}_{h_{-j} \sim q(h_{-j}|v; \phi)} h_l + b_j \\ =&amp; \sum_{i} W_{ij} x_i + \sum_{l \neq j} A_{lj} [1 \times \mu_l + 0 \times (1 - \mu_l)] + b_j \\ =&amp; \sum_{i} W_{ij} x_i + \sum_{l \neq j} A_{lj} \mu_l + b_j \end{split} \end{align}\] <p>Như vậy, ta đã chứng minh được (\(\ref{eq:mu_j}\)).</p> <p><strong>Lưu ý</strong> Trong trường hợp ta đang xét \(\{-1, 1\}^d\) thì \(\mu_j\) được tính theo công thức</p> \[\begin{align} \mu_j = \sigma \left( \sum_{i} 2 W_{ij} v_i + \sum_{l \neq j} 2 A_{lj} (2 \mu_l - 1) + 2 b_j \right) \end{align}\] <h2 id="hứa-hẹn">Hứa hẹn</h2> <p>Ở phần tiếp theo, chúng ta sẽ bàn về cách huấn luyện máy Boltzmann và máy Boltzmann giới hạn, sử dụng những biến đổi được cho ở trên.</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/"></d-bibliography> <div id="giscus_thread" style="max-width: 800px; margin: 0 auto;"> <script>let giscusTheme=localStorage.getItem("theme"),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"vltanh/vltanh.github.io","data-repo-id":"","data-category":"Comments","data-category-id":"","data-mapping":"title","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,e])=>giscusScript.setAttribute(t,e)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 The-Anh Vu-Le. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-JS11DTCF4Y"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-JS11DTCF4Y");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>