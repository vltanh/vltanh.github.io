<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="google-site-verification" content="1BWHOhCt_eijp5wvU_9Cvh591AfMs_im4cOLhN3wkP4"> <meta http-equiv="Permissions-Policy" content="interest-cohort=()"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Suy diễn Biến phân (Phần 2) | The-Anh Vu-Le (Nah) </title> <meta name="author" content="The-Anh Vu-Le"> <meta name="description" content="a fake trying to be real "> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%90%96&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://vltanh.github.io//blog/2024/vi-2/"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?0afe9f0ae161375728f7bcc5eb5b4ab4"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> </head> <body> <d-front-matter> <script async type="text/json">
      {
            "title": "Suy diễn Biến phân (Phần 2)",
            "description": "",
            "published": "March 13, 2024",
            "authors": [
              
              {
                "author": "The-Anh Vu-Le",
                "authorURL": "",
                "affiliations": [
                  {
                    "name": "",
                    "url": ""
                  }
                ]
              }
              
            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> The-Anh Vu-Le (Nah) </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>Suy diễn Biến phân (Phần 2)</h1> <p></p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div> <a href="#b%E1%BB%91i-c%E1%BA%A3nh">Bối cảnh</a> </div> <div> <a href="#m%C3%B4-h%C3%ACnh">Mô hình</a> </div> <div> <a href="#%C4%91%E1%BA%B7t-v%E1%BA%A5n-%C4%91%E1%BB%81">Đặt vấn đề</a> </div> <div> <a href="#suy-di%E1%BB%85n-bi%E1%BA%BFn-ph%C3%A2n-v%E1%BB%9Bi-tr%C6%B0%E1%BB%9Dng-trung-b%C3%ACnh">Suy diễn biến phân với trường trung bình</a> </div> <ul> <li> <a href="#h%E1%BB%8D-ph%C3%A2n-ph%E1%BB%91i-tr%C6%B0%E1%BB%9Dng-trung-b%C3%ACnh">Họ phân phối trường trung bình</a> </li> <li> <a href="#gia-t%C4%83ng-t%E1%BB%ABng-t%E1%BB%8Da-%C4%91%E1%BB%99">Gia tăng từng tọa độ</a> </li> <li> <a href="#thu%E1%BA%ADt-to%C3%A1n-cavi">Thuật toán CAVI</a> </li> </ul> <div> <a href="#gi%E1%BA%A3i-quy%E1%BA%BFt-b%C3%A0i-to%C3%A1n">Giải quyết bài toán</a> </div> <ul> <li> <a href="#h%E1%BB%8D-ph%C3%A2n-ph%E1%BB%91i-tr%C6%B0%E1%BB%9Dng-trung-b%C3%ACnh">Họ phân phối trường trung bình</a> </li> <li> <a href="#t%C3%ADnh-to%C3%A1n-c%C3%A1c-c%E1%BA%ADp-nh%E1%BA%ADt">Tính toán các cập nhật</a> </li> <li> <a href="#thu%E1%BA%ADt-to%C3%A1n">Thuật toán</a> </li> </ul> <div> <a href="#t%E1%BB%95ng-k%E1%BA%BFt-v%C3%A0-h%E1%BB%A9a-h%E1%BA%B9n">Tổng kết và hứa hẹn</a> </div> </nav> </d-contents> <p>Ở <a href="../vi-1/">Phần 1</a>, chúng ta đã xem xét một ví dụ đơn giản của suy diễn biến phân. Trong bài viết ngày hôm nay, chúng ta sẽ xem xét một ví dụ phức tạp hơn, đòi hỏi các giả định mạnh hơn để giải quyết.</p> <h2 id="bối-cảnh">Bối cảnh</h2> <p>Một bóng đèn có <strong>tuổi thọ thực tế</strong> \(\Theta\) là một biến ngẫu nhiên tuân theo phân phối lũy thừa với hằng số \(\Lambda\). Khác với phần trước, ở đây \(\Lambda\) là một biến ngẫu nhiên tuân theo phân phối Gamma với hằng số \(\alpha &gt; 0\) và \(\beta &gt; 0\). Khi sử dụng, <strong>tuổi thọ thực nghiệm</strong> \(X\) của bóng đèn có tồn tại một nhiễu ngẩu nhiên với phân phối chuẩn (Gaussian) có kỳ vọng \(0\) và phương sai \(\sigma^2 \in (0, \infty)\). Giả sử ta có một bóng đèn với tuổi thọ thực nghiệm là \(x &gt; 0\), ước lượng tuổi thọ thực tế của nó.</p> <h2 id="mô-hình">Mô hình</h2> <p>Mô hình sinh của tuổi thọ thực nghiệm là một mô hình phân tầng (hierarchical model) được mô tả như sau</p> \[\begin{align*} \Lambda &amp;\sim \text{Gamma}(\alpha, \beta) \\ \Theta|\Lambda = \lambda &amp;\sim \text{Exp}(\lambda) \\ X|\Theta = \theta &amp;\sim \text{N}(\theta, \sigma^2) \end{align*}\] <p>Dựa trên mô hình này, phân phối kết hợp (joint distribution) của tuổi thọ thực nghiệm và tuổi thọ thực tế là</p> \[p_{X, \Theta, \Lambda}(x, \theta, \lambda) = p_{X|\theta}(x|\theta) p_{\Theta|\lambda}(\theta) p_{\Lambda}(\lambda) = \mathcal{N}(x; \theta, \sigma^2)\text{Exp}(\theta; \lambda) \text{Gamma}(\lambda; \alpha, \beta)\] <p>trong đó</p> \[\begin{align*} \mathcal{N}(x; \theta, \sigma^2) &amp;= \dfrac{1}{\sqrt{2\pi\sigma^2}} \exp\left[-\dfrac{(x - \theta)^2}{2\sigma^2}\right] \\ \text{Exp}(\theta; \lambda) &amp;= \lambda \exp(-\lambda \theta) \mathbb{1}_{[0, \infty)}(\theta) \\ \text{Gamma}(\lambda; \alpha, \beta) &amp;= \dfrac{\beta^\alpha}{\Gamma(\alpha)} \lambda^{\alpha - 1} \exp(-\beta\lambda) \mathbb{1}_{(0, \infty)}(\lambda) \end{align*}\] <p>Tương tự như ví dụ trước, ta mong muốn tính được phân phối hậu nghiệm kết hợp (joint posterior distribution) của cả tham số tỉ lệ \(\Lambda\) lẫn tuổi thọ thực tế \(\Theta\) dựa trên dữ liệu quan sát được:</p> \[p_{\Theta, \Lambda|x}(\theta, \lambda) = \dfrac{p_{X, \Theta, \Lambda}(x, \theta, \lambda)}{p_X(x)}\] <h2 id="đặt-vấn-đề">Đặt vấn đề</h2> <p>Việc phải ước lượng cả hai tham số \(\Lambda\) và \(\Theta\) cùng lúc khiến cho bài toán trở nên khó khăn hơn. Không những thế, hai biến ngẫu nhiên này còn không độc lập! Điều này đồng nghĩa với việc ta không thể phân rã phân phối hậu nghiệm kết hợp thành các thành phần không phụ thuộc vào nhau, và việc tối ưu cũng không còn dễ dàng nữa.</p> <h2 id="suy-diễn-biến-phân-với-trường-trung-bình">Suy diễn biến phân với trường trung bình</h2> <p><strong>Suy diễn biến phân với trường trung bình</strong> (mean-field variational inference) là một trong những cách tiếp cận phổ biến trong các trường hợp như vậy.</p> <h3 id="họ-phân-phối-trường-trung-bình">Họ phân phối trường trung bình</h3> <p>Ý tưởng chính của phương pháp này là giả định họ phân phối biến phân (variational distribution family) là <strong>họ trường trung bình</strong> (mean-field family). Đây là họ các phân bố phân rã được (factorizable). Nói cách khác, các biến ngẫu nhiên được giả định là độc lập với nhau, mỗi biến tuân theo một phân phối phần tử (factor) riêng. Cụ thể, các phân phối trong thuộc họ trường trung bình trên không gian vector ngẫu nhiên \(m\)-chiều \(\vec{\Theta} = (\Theta_1, \dots, \Theta_m)\) có dạng</p> \[q_{\vec{\Theta}}(\vec{\theta}) = \prod_{i=1}^m q_{\Theta_i}(\theta_i)\] <p>Hãy nhớ lại về định nghĩa ELBO:</p> \[\text{ELBO}(q_{\vec{\Theta}}, p_{X, \vec{\Theta}}) = \mathbb{E}_{q_{\vec{\Theta}}}\left[ \log p_{X, \vec{\Theta}}(x, \vec{\Theta}) - \log q_{\vec{\Theta}}(\vec{\Theta}) \right]\] <p>Trong đó, hân phối kết hợp có thể được phân tách như sau</p> \[p_{X, \vec{\Theta}}(x, \vec{\Theta}) = p_{X}(x) p_{\vec{\Theta}|x}(\vec{\Theta}) % = p_{X}(x) \prod_{j = 1}^{m} p_{\Theta_j|x, \Theta_{1:j-1}}(\Theta_j)\] <p>và do đó</p> \[\begin{align*} \mathbb{E}_{q_{\vec{\Theta}}}\left[ \log p_{X, \vec{\Theta}}(x, \vec{\Theta}) \right] &amp; = \log p_{X}(x) + \mathbb{E}_{q_{\vec{\Theta}}} \left[ \log p_{\vec{\Theta}|x}(\vec{\Theta}) \right] \end{align*}\] <p>Với việc sử dụng họ phân phối trường trung bình,</p> \[\begin{align*} \mathbb{E}_{q_{\vec{\Theta}}}\left[ \log q_{\vec{\Theta}}(\vec{\Theta}) \right] &amp; = \int q_{\vec{\Theta}}(\vec{\theta}) \log q_{\vec{\Theta}}(\vec{\theta}) d\vec{\theta} \\ &amp; = \int \left( \prod_{j=1}^m q_{\Theta_j}(\theta_j) \right) \left( \sum_{j = 1}^{m} \log q_{\Theta_j}(\theta_j) \right) d\vec{\theta} \\ &amp; = \sum_{j = 1}^{m} \int \left( \prod_{k = 1}^{m} q_{\Theta_k}(\theta_k) \right) \log q_{\Theta_j}(\theta_j) d\vec{\theta} \\ &amp; = \sum_{j = 1}^{m} \left( \int \prod_{k \neq j} q_{\Theta_k}(\theta_k) d\vec{\theta}_{-j} \right) \left( \int q_{\Theta_j}(\theta_j) \log q_{\Theta_j}(\theta_j) d\theta_j \right) \\ &amp; = \sum_{j = 1}^{m} \mathbb{E}_{q_{\Theta_j}}\left[ \log q_{\Theta_j}(\Theta_j) \right] \end{align*}\] <p>Kết hợp 2 điều trên, ELBO trở thành</p> \[\begin{align*} &amp; \text{ELBO}(q_{\vec{\Theta}}, p_{X, \vec{\Theta}}) \\ &amp;= \log p_{X}(x) + \sum_{j=1}^{m} \mathbb{E}_{q_{\Theta_j}} \left\{ \mathbb{E}_{q_{\vec{\Theta}_{-j}}} \left[ \log p_{\Theta_j|x, \vec{\Theta}_{-j}}(\Theta_j) \right] - \log q_{\Theta_j}(\Theta_j) \right\} \end{align*}\] <h3 id="gia-tăng-từng-tọa-độ">Gia tăng từng tọa độ</h3> <p>Việc có thể viết được ELBO dưới dạng trên cho thấy rằng việc tìm \(q_{\vec{\Theta}}\) tối ưu ELBO có thể được thực hiện thông qua việc tối ưu tuần tự từng thành phần khi giữ cố định các thành phần còn lại. Phương pháp này được gọi là phương pháp <strong>gia tăng từng tọa độ</strong> (coordinate ascent).</p> <p>Xét tọa độ \(k \in [m]\). Khi giữ cố định \(q_{\Theta_{-k}}\), ta có thể tìm \(q_{\Theta_k}\) để tối ưu ELBO bằng cách xét đạo hàm bằng không. ELBO khi chỉ xét đến thành phần \(\Theta_k\) là</p> \[\text{ELBO}(q_{\Theta_k}; q_{\vec{\Theta}}, p_{X, \vec{\Theta}}) \stackrel{c}{=} \mathbb{E}_{q_{\Theta_k}} \left\{ \mathbb{E}_{q_{\vec{\Theta}_{-k}}} \left[ \log p_{\Theta_k|x, \vec{\Theta}_{-k}}(\Theta_k) - \log q_{\Theta_k}(\Theta_k) \right] \right\}\] <p>Đạo hàm theo \(q_{\Theta_k}(\theta_k)\) là</p> \[\dfrac{\partial}{\partial q_{\Theta_k}(\theta_k)} \text{ELBO}(q_{\Theta_k}; q_{\vec{\Theta}}, p_{X, \vec{\Theta}}) = \mathbb{E}_{q_{\vec{\Theta}_{-k}}} \left[ \log p_{\Theta_k|x, \vec{\Theta}_{-k}}(\theta_k) \right] - \log q_{\Theta_k}(\theta_k) - 1\] <p>Đặt đạo hàm bằng không, ta có</p> \[\log q^\star_{\Theta_k}(\theta_k) \stackrel{c}{=} \mathbb{E}_{q_{\vec{\Theta}_{-k}}} \left[ \log p_{\Theta_k|x, \vec{\Theta}_{-k}}(\theta_k) \right]\] <p>hay</p> \[q^\star_{\Theta_k}(\theta_k) \propto \exp\left\{ \mathbb{E}_{q_{\vec{\Theta}_{-k}}} \left[ \log p_{\Theta_k|x, \vec{\Theta}_{-k}}(\theta_k) \right] \right\}\] <p>\(p_{\Theta_k\\|x, \vec{\Theta}_{-k}}\) được gọi là phân phối điều kiện hoàn toàn (complete conditional) của biến \(\Theta_k\). Trong một số trường hợp, ta có thể giả định thêm về nó để thuận tiện cho việc tính toán. Tuy nhiên, việc này nằm quá giới hạn của bài viết này và sẽ được thảo luận ở phần sau (nếu có).</p> <p>Ở đây, ta tiếp cận nó theo một hướng khác, sử dụng việc</p> \[p_{\Theta_k|x, \vec{\Theta}_{-k}}(\theta_k) = \dfrac{ p_{X, \vec{\Theta}}(x, \theta_k, \vec{\Theta}_{-k}) }{ p_{X, \vec{\Theta}_{-k}}(x, \vec{\Theta}_{-k}) }\] <p>với \(p_{X, \vec{\Theta}_{-k}}(x, \vec{\Theta}_{-k})\) không phụ thuộc vào \(\theta_k\), ta có</p> \[q^\star_{\Theta_k}(\theta_k) \propto \exp\left\{ \mathbb{E}_{q_{\vec{\Theta}_{-k}}} \left[ \log p_{X, \vec{\Theta}}(x, \theta_k, \vec{\Theta}_{-k}) \right] \right\}\] <p>Trong một số trường hợp, ta có thể tính được kỳ vọng này một cách dễ dàng.</p> <h3 id="thuật-toán-cavi">Thuật toán CAVI</h3> <p>Tóm lại, thuật toán gia tăng từng tọa độ để tối ưu ELBO khi sử dụng họ phân phối trường trung bình, gọi tên là CAVI (Coordinate Ascent Variational Inference), có thể được mô tả như sau:</p> <ol> <li>Khởi tạo \(q_{\Theta}\) ngẫu nhiên</li> <li>Lặp lại cho đến khi hội tụ: <ol> <li> <p>Với mỗi \(k = 1, \dots, m\), cập nhật</p> \[q_{\Theta_k}(\theta_k) = \exp\left\{ \mathbb{E}_{q_{\vec{\Theta}_{-k}}} \left[ \log p_{X, \vec{\Theta}}(x, \theta_k, \vec{\Theta}_{-k}) \right] \right\}\] </li> <li> <p>Chuẩn hóa \(q_{\Theta}\)</p> </li> </ol> </li> </ol> <h2 id="giải-quyết-bài-toán">Giải quyết bài toán</h2> <h3 id="họ-phân-phối-trường-trung-bình-1">Họ phân phối trường trung bình</h3> <p>Trong trường hợp này, ta giả định họ phân phối trường trung bình cho cả hai biến ngẫu nhiên \(\Lambda\) và \(\Theta\):</p> \[q_{\Theta, \Lambda}(\theta, \lambda) = q_{\Theta}(\theta) q_{\Lambda}(\lambda)\] <p>Một điều đặc biệt là ta không hề giả định gì về từng thành phần \(q_{\Theta}\) và \(q_{\Lambda}\) cả, khác với phần trước khi ta giả định \(q_{\Theta}\) là một phân phối chuẩn.</p> <h3 id="tính-toán-các-cập-nhật">Tính toán các cập nhật</h3> <p>Theo như thuật toán trên, các cập nhật sẽ là</p> \[\begin{align*} q_{\Theta}(\theta) &amp;\propto \exp\left\{ \mathbb{E}_{q_{\Lambda}} \left[ \log p_{X, \Theta, \Lambda}(x, \theta, \Lambda) \right] \right\} \\ q_{\Lambda}(\lambda) &amp;\propto \exp\left\{ \mathbb{E}_{q_{\Theta}} \left[ \log p_{X, \Theta, \Lambda}(x, \Theta, \lambda) \right] \right\} \end{align*}\] <p><strong>Phân phối kết hợp</strong> Để tính được bước cập nhật cho từng tọa độ, ta cần biến đổi phân phối kết hợp \(p_{X, \Theta, \Lambda}\).</p> \[\begin{align*} p_{X, \Theta, \Lambda}(x, \theta, \lambda) &amp;= p_{X|\Theta, \Lambda}(x|\theta, \lambda) p_{\Theta|\Lambda}(\theta|\lambda) p_{\Lambda}(\lambda) \\ &amp;= \mathcal{N}(x; \theta, \sigma^2) \text{Exp}(\theta; \lambda) \text{Gamma}(\lambda; \alpha, \beta) \\ &amp;\propto \exp\left[ -\dfrac{1}{2\sigma^2} (x - \theta)^2 \right] \lambda \exp(- \lambda \theta) \lambda^{\alpha - 1} \exp(- \beta\lambda) \end{align*}\] <p>Từ đó, ta có thể tính được</p> \[\begin{align*} \log p_{X, \Theta, \Lambda}(x, \theta, \lambda) &amp;\stackrel{c}{=} -\dfrac{1}{2\sigma^2} (x - \theta)^2 - \lambda \theta + \alpha \log \lambda - \beta \lambda \end{align*}\] <p><strong>Cập nhật của \(q_{\Theta}\)</strong> Lược bỏ đi các thành phần không liên quan đến \(\theta\), ta có</p> \[\begin{align*} \mathbb{E}_{q_{\Lambda}} \left[ \log p_{X, \Theta, \Lambda}(x, \theta, \Lambda) \right] &amp;\stackrel{c}{=} -\dfrac{1}{2\sigma^2} (x - \theta)^2 - \mathbb{E}_{q_{\Lambda}}[\Lambda] \theta \\ &amp;\stackrel{c}{=} -\dfrac{1}{2\sigma^2} \theta^2 + \left( \dfrac{x}{\sigma^2} - \mathbb{E}_{q_{\Lambda}}[\Lambda] \right) \theta \\ &amp; = -\dfrac{1}{2\sigma^2} \left[ \theta^2 - 2(x - \sigma^2 \mathbb{E}_{q_{\Lambda}}[\Lambda])\theta \right] \\ &amp;\stackrel{c}{=} -\dfrac{1}{2\sigma^2} \left[ \theta - (x - \sigma^2 \mathbb{E}_{q_{\Lambda}}[\Lambda]) \right]^2 \end{align*}\] <p>Như vậy, cập nhật cho \(q_{\Theta}\) sẽ là</p> \[\begin{align*} q_{\Theta}(\theta) &amp;\propto \exp\left\{ -\dfrac{1}{2\sigma^2} \left[ \theta - (x - \sigma^2 \mathbb{E}_{q_{\Lambda}}[\Lambda]) \right]^2 \right\} \end{align*}\] <p>Nếu để ý, ta sẽ nhận ra rằng</p> \[q_{\Theta}(\theta) = \mathcal{N}(\theta; x - \sigma^2 \mathbb{E}_{q_{\Lambda}}[\Lambda], \sigma^2)\] <p>Ở đây, \(\mathbb{E}_{q_{\Lambda}}[\Lambda]\) đang được bỏ ngõ, do ta chưa có đủ thông tin về \(q_{\Lambda}\). Ta sẽ tính nó ngay sau đây.</p> <p><strong>Cập nhật của \(q_{\Lambda}\)</strong> Lược bỏ đi các thành phần không liên quan đến \(\lambda\), ta có</p> \[\begin{align*} \mathbb{E}_{q_{\Theta}} \left[ \log p_{X, \Theta, \Lambda}(x, \Theta, \lambda) \right] &amp;\stackrel{c}{=} \alpha \log \lambda - (\beta + \mathbb{E}_{q_{\Theta}}[\Theta]) \lambda \end{align*}\] <p>Như vậy, cập nhật cho \(q_{\Lambda}\) sẽ là</p> \[\begin{align*} q_{\Lambda}(\lambda) &amp;\propto \exp\left\{ \alpha \log \lambda - (\beta + \mathbb{E}_{q_{\Theta}}[\Theta]) \lambda \right\} = \lambda^{\alpha} \exp(- (\beta + \mathbb{E}_{q_{\Theta}}[\Theta]) \lambda) \end{align*}\] <p>Nếu để ý, ta sẽ lại nhận ra rằng</p> \[q_{\Lambda}(\lambda) = \text{Gamma}(\lambda; \alpha + 1, \beta + \mathbb{E}_{q_{\Theta}}[\Theta])\] <p>Lại một lần nữa, \(\mathbb{E}_{q_{\Theta}}[\Theta]\) đang được bỏ ngỏ. Tuy nhiên, dựa vào kết quả ở trên, ta biết \(q_{\Theta}\) là một phân phối chuẩn, và do đó \(\mathbb{E}_{q_{\Theta}}[\Theta]\) có thể được tính toán một cách dễ dàng. Song song đó, ta cũng có thể tính \(\mathbb{E}_{q_{\Lambda}}[\Lambda]\) một cách dễ dàng.</p> <h3 id="thuật-toán">Thuật toán</h3> <p>Tóm lại, thuật toán để giải quyết bài toán đầu đề có thể được mô tả như sau:</p> <ol> <li>Khởi tạo \(\alpha_{\Lambda}^{(0)} = \alpha, \beta_{\Lambda}^{(0)} = \beta\)</li> <li>Với mỗi \(t = 0, 1, \dots\): <ol> <li> <p>Cập nhật</p> \[\mu_{\Theta}^{(t + 1)} = x - \sigma^2 \dfrac{\alpha_{\Lambda}^{(t)}}{\beta_{\Lambda}^{(t)}}\] <p>và theo đó</p> \[q_{\Theta}^{(t + 1)}(\theta) = \mathcal{N} \left( \theta; \mu_{\Theta}^{(t + 1)}, \sigma^2 \right)\] </li> <li> <p>Cập nhật</p> \[\begin{align*} \alpha_{\Lambda}^{(t + 1)} &amp;= \alpha_{\Lambda}^{(t)} + 1 \\ \beta_{\Lambda}^{(t + 1)} &amp;= \beta_{\Lambda}^{(t)} + \mu_{\Theta}^{(t + 1)} \end{align*}\] <p>và theo đó</p> \[q_{\Lambda}^{(t + 1)}(\lambda) = \text{Gamma}\left(\lambda; \alpha_{\Lambda}^{(t + 1)}, \beta_{\Lambda}^{(t + 1)}\right)\] </li> </ol> </li> </ol> <h3 id="minh-họa">Minh họa</h3> <p>Nếu quan tâm, mọi người có thể thử tại <a href="https://www.desmos.com/calculator/un292buf0z" rel="external nofollow noopener" target="_blank">đây</a> để so sánh giữa phân phối hậu nghiệm chính xác và phân phối biến phân tại các bước của thuật toán.</p> <div align="center"> <iframe src="https://www.desmos.com/calculator/un292buf0z?embed" width="500" height="500" style="border: 1px solid #ccc" frameborder="0"></iframe> </div> <p>Hình trên vẽ mặt cắt \(h = 0.005\) của các phân phối. Trong đó, theo thứ tự màu đen, đỏ, xanh lam, xanh lục, cam, tím lần lượt là phân phối hậu nghiệm chính xác và các phân phối biến phân theo CAVI tại các bước từ 1 đến 5.</p> <p>Có thể thấy giả định trường trung bình đã giới hạn khả năng xấp xỉ của phân phối biến phân. Bên cạnh đó, do ta đang tối ưu phân kỳ KL \(\text{KL}(q_{\Theta, \Lambda} \| p_{\Theta, \Lambda\\|x})\), phân phối biến phân không cố gắng che phủ (như trong trường hợp tối ưu phân kỳ KL hướng ngược lại) mà thay vào đó muốn nằm gọn trong phân phối hậu nghiệm chính xác.</p> <h2 id="tổng-kết-và-hứa-hẹn">Tổng kết và hứa hẹn</h2> <p>Trong bài viết này, chúng ta đã thảo luận về một ví dụ phức tạp hơn của suy diễn biến phân, và cách tiếp cận nó thông qua phương pháp suy diễn biến phân với trường trung bình. Bài viết này có thể sẽ được cập nhật để thêm phần cài đặt và mô phỏng kết quả.</p> <p>Trong các phần tiếp theo (nếu có), chúng ta sẽ xem xét một số ví dụ khác, đôi chút phức tạp hơn, nhưng vẫn có thể giải quyết được bằng phương pháp này. Hy vọng được gặp lại!</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/"></d-bibliography> <div id="giscus_thread" style="max-width: 800px; margin: 0 auto;"> <script>let giscusTheme=localStorage.getItem("theme"),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"vltanh/vltanh.github.io","data-repo-id":"","data-category":"Comments","data-category-id":"","data-mapping":"title","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,e])=>giscusScript.setAttribute(t,e)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 The-Anh Vu-Le. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-JS11DTCF4Y"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-JS11DTCF4Y");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>